function Cell(t,e,i,o,s){this.nodeId=t,this.owner=e,this.color={r:0,g:255,b:0},this.position=i,this.mass=o,this.cellType=-1,this.spiked=0,this.killedBy,this.gameServer=s,this.moveEngineTicks=0,this.moveEngineSpeed=0,this.moveDecay=.75,this.angle=0}module.exports=Cell,Cell.prototype.getName=function(){return this.owner?this.owner.name:""},Cell.prototype.setColor=function(t){this.color.r=t.r,this.color.b=t.b,this.color.g=t.g},Cell.prototype.getColor=function(){return this.color},Cell.prototype.getType=function(){return this.cellType},Cell.prototype.getSize=function(){return Math.ceil(Math.sqrt(100*this.mass))},Cell.prototype.getSquareSize=function(){return 100*this.mass>>0},Cell.prototype.addMass=function(t){this.mass+t>this.owner.gameServer.config.playerMaxMass&&this.owner.cells.length<this.owner.gameServer.config.playerMaxCells?(this.mass=(this.mass+t)/2,this.owner.gameServer.newCellVirused(this.owner,this,0,this.mass,150)):this.mass=Math.min(this.mass+t,this.owner.gameServer.config.playerMaxMass)},Cell.prototype.getSpeed=function(){return this.owner.gameServer.config.playerSpeed*Math.pow(this.mass,-1/4.5)*50/40},Cell.prototype.setAngle=function(t){this.angle=t},Cell.prototype.getAngle=function(){return this.angle},Cell.prototype.setMoveEngineData=function(t,e,i){this.moveEngineSpeed=t,this.moveEngineTicks=e,this.moveDecay=isNaN(i)?.75:i},Cell.prototype.getEatingRange=function(){return 0},Cell.prototype.getKiller=function(){return this.killedBy},Cell.prototype.setKiller=function(t){this.killedBy=t},Cell.prototype.collisionCheck=function(t,e,i,o){return this.position.y>t?!1:this.position.y<e?!1:this.position.x>i?!1:this.position.x<o?!1:!0},Cell.prototype.collisionCheck2=function(t,e){var i=this.position.x-e.x,o=this.position.y-e.y;return i*i+o*o+this.getSquareSize()<=t},Cell.prototype.visibleCheck=function(t,e){return this.collisionCheck(t.bottomY,t.topY,t.rightX,t.leftX)},Cell.prototype.calcMovePhys=function(t){var e=this.moveEngineSpeed,i=this.getSize();this.moveEngineSpeed*=this.moveDecay,this.moveEngineTicks--;var o=Math.sin(this.angle),s=Math.cos(this.angle);if(0==this.cellType){var n=i,r=0;do{r=Math.min(r+n,e);var l=this.position.x+r*o,h=this.position.y+r*s,p=this.position.x,a=this.position.y;this.position.x=l,this.position.y=h;for(var g=this.gameServer.getCellsInRange(this),c=0;c<g.length;c++){var y=g[c];y.onConsume(this,this.gameServer),y.setKiller(this),this.gameServer.removeNode(y)}this.position.x=p,this.position.y=a}while(e>r)}else if(3==this.cellType){var v=2*i-5,n=i,r=0,m=0,u=0;do{r=Math.min(r+n,e);for(var l=this.position.x+r*o+m,h=this.position.y+r*s+u,d=0;d<this.gameServer.nodesEjected.length;d++){var f=this.gameServer.nodesEjected[d];if(this.nodeId!=f.nodeId&&this.simpleCollide(l,h,f,v)){var C=this.getDist(l,h,f.position.x,f.position.y);if(v>C){var S=f.position.y-h,M=f.position.x-l,x=Math.atan2(M,S),b=(v-C+5)/2,E=b*Math.sin(x),w=b*Math.cos(x);f.position.x+=E>>0,f.position.y+=w>>0,m+=-E,u+=-w,0==f.moveEngineTicks&&(f.setMoveEngineData(0,1),-1==this.gameServer.movingNodes.indexOf(f)&&this.gameServer.setAsMovingNode(f)),0==this.moveEngineTicks&&this.setMoveEngineData(0,1)}}}}while(e>r);l=this.position.x+e*o+m,h=this.position.y+e*s+u}else var l=this.position.x+e*o,h=this.position.y+e*s;var k=40;l-k<t.borderLeft&&(this.angle=6.28-this.angle,l=t.borderLeft+k),l+k>t.borderRight&&(this.angle=6.28-this.angle,l=t.borderRight-k),h-k<t.borderTop&&(this.angle=this.angle<=3.14?3.14-this.angle:9.42-this.angle,h=t.borderTop+k),h+k>t.borderBottom&&(this.angle=this.angle<=3.14?3.14-this.angle:9.42-this.angle,h=t.borderBottom-k),this.position.x=l>>0,this.position.y=h>>0},Cell.prototype.sendUpdate=function(){return!0},Cell.prototype.onConsume=function(t,e){},Cell.prototype.onAdd=function(t){},Cell.prototype.onRemove=function(t){},Cell.prototype.onAutoMove=function(t){},Cell.prototype.moveDone=function(t){},Cell.prototype.simpleCollide=function(t,e,i,o){var s=o>>0;return this.abs(t-i.position.x)<s&&this.abs(e-i.position.y)<s},Cell.prototype.abs=function(t){return 0>t?-t:t},Cell.prototype.getDist=function(t,e,i,o){var s=i-t;s*=s;var n=o-e;return n*=n,Math.sqrt(s+n)};