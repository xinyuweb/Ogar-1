function Virus(){Cell.apply(this,Array.prototype.slice.call(arguments)),this.cellType=2,this.spiked=1,this.fed=0,this.isMotherCell=!1}var Cell=require("./Cell");module.exports=Virus,Virus.prototype=new Cell,Virus.prototype.calcMove=null,Virus.prototype.feed=function(e,s){this.setAngle(e.getAngle()),this.mass+=e.mass,this.fed++,s.removeNode(e),this.fed>=s.config.virusFeedAmount&&(this.mass=s.config.virusStartMass,this.fed=0,s.shootVirus(this))},Virus.prototype.getEatingRange=function(){return.4*this.getSize()},Virus.prototype.onConsume=function(e,s){var i=e.owner,o=Math.floor(e.mass/16)-1,t=s.config.playerMaxCells-i.cells.length;t=Math.min(t,o);var r=Math.min(e.mass/(t+1),36);if(e.addMass(this.mass),!(0>=t)){var n=0,a=e.mass-t*r;a>300&&t>0&&(n++,t--),a>1200&&t>0&&(n++,t--),a>3e3&&t>0&&(n++,t--),a=e.mass-t*r;for(var l=0;n>l;l++)a*=.75;for(var u=Math.ceil(Math.sqrt(100*a)),h=(u+500*Math.min(200/u,1))/3.6,p=0,l=0;t>l;l++)p+=6.28/t,s.newCellVirused(i,e,p,r,h),e.mass-=r;for(var l=0;n>l;l++)p=6.28*Math.random(),r=e.mass/4,s.newCellVirused(i,e,p,r,h),e.mass-=r;e.calcMergeTime(s.config.playerRecombineTime)}},Virus.prototype.onAdd=function(e){e.nodesVirus.push(this)},Virus.prototype.onRemove=function(e){var s=e.nodesVirus.indexOf(this);-1!=s?e.nodesVirus.splice(s,1):console.log("[Warning] Tried to remove a non existing virus!")},Virus.prototype.onAutoMove=function(e){for(var s=100,i=e.nodesEjected.length,o=0;i>o;o++){var t=e.nodesEjected[o],r=t.position.y-s,n=t.position.y+s,a=t.position.x-s,l=t.position.x+s;this.collisionCheck(n,r,l,a)&&(t.angle=this.angle,this.feed(t,e),o--,i--)}};